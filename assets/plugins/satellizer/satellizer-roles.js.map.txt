{"version":3,"file":null,"sources":["../src/config.ts","../src/authProvider.ts","../src/utils.ts","../src/shared.ts","../src/local.ts","../src/popup.ts","../src/oauth1.ts","../src/oauth2.ts","../src/oauth.ts","../src/storage.ts","../src/interceptor.ts","../src/httpProviderConfig.ts","../src/ng1.ts"],"sourcesContent":["export default class Config {\r\n  static get getConstant() {\r\n    return new Config();\r\n  }\r\n\r\n  baseUrl = '/';\r\n  loginUrl = '/auth/login';\r\n  signupUrl = '/auth/signup';\r\n  unlinkUrl = '/auth/unlink/';\r\n  tokenName = 'token';\r\n  tokenPrefix = 'satellizer';\r\n  tokenHeader = 'Authorization';\r\n  tokenType = 'Bearer';\r\n  storageType = 'localStorage';\r\n  tokenRoot = null;\r\n  withCredentials = false;\r\n  providers = {\r\n    facebook: {\r\n      name: 'facebook',\r\n      url: '/auth/facebook',\r\n      authorizationEndpoint: 'https://www.facebook.com/v2.5/dialog/oauth',\r\n      redirectUri: window.location.origin + '/',\r\n      requiredUrlParams: ['display', 'scope'],\r\n      scope: ['email'],\r\n      scopeDelimiter: ',',\r\n      display: 'popup',\r\n      oauthType: '2.0',\r\n      popupOptions: { width: 580, height: 400 }\r\n    },\r\n    google: {\r\n      name: 'google',\r\n      url: '/auth/google',\r\n      authorizationEndpoint: 'https://accounts.google.com/o/oauth2/auth',\r\n      redirectUri: window.location.origin,\r\n      requiredUrlParams: ['scope'],\r\n      optionalUrlParams: ['display', 'state'],\r\n      scope: ['profile', 'email'],\r\n      scopePrefix: 'openid',\r\n      scopeDelimiter: ' ',\r\n      display: 'popup',\r\n      oauthType: '2.0',\r\n      popupOptions: { width: 452, height: 633 },\r\n      state: () => encodeURIComponent(Math.random().toString(36).substr(2))\r\n    },\r\n    github: {\r\n      name: 'github',\r\n      url: '/auth/github',\r\n      authorizationEndpoint: 'https://github.com/login/oauth/authorize',\r\n      redirectUri: window.location.origin,\r\n      optionalUrlParams: ['scope'],\r\n      scope: ['user:email'],\r\n      scopeDelimiter: ' ',\r\n      oauthType: '2.0',\r\n      popupOptions: { width: 1020, height: 618 }\r\n    },\r\n    instagram: {\r\n      name: 'instagram',\r\n      url: '/auth/instagram',\r\n      authorizationEndpoint: 'https://api.instagram.com/oauth/authorize',\r\n      redirectUri: window.location.origin,\r\n      requiredUrlParams: ['scope'],\r\n      scope: ['basic'],\r\n      scopeDelimiter: '+',\r\n      oauthType: '2.0'\r\n    },\r\n    linkedin: {\r\n      name: 'linkedin',\r\n      url: '/auth/linkedin',\r\n      authorizationEndpoint: 'https://www.linkedin.com/uas/oauth2/authorization',\r\n      redirectUri: window.location.origin,\r\n      requiredUrlParams: ['state'],\r\n      scope: ['r_emailaddress'],\r\n      scopeDelimiter: ' ',\r\n      state: 'STATE',\r\n      oauthType: '2.0',\r\n      popupOptions: { width: 527, height: 582 }\r\n    },\r\n    twitter: {\r\n      name: 'twitter',\r\n      url: '/auth/twitter',\r\n      authorizationEndpoint: 'https://api.twitter.com/oauth/authenticate',\r\n      redirectUri: window.location.origin,\r\n      oauthType: '1.0',\r\n      popupOptions: { width: 495, height: 645 }\r\n    },\r\n    twitch: {\r\n      name: 'twitch',\r\n      url: '/auth/twitch',\r\n      authorizationEndpoint: 'https://api.twitch.tv/kraken/oauth2/authorize',\r\n      redirectUri: window.location.origin,\r\n      requiredUrlParams: ['scope'],\r\n      scope: ['user_read'],\r\n      scopeDelimiter: ' ',\r\n      display: 'popup',\r\n      oauthType: '2.0',\r\n      popupOptions: { width: 500, height: 560 }\r\n    },\r\n    live: {\r\n      name: 'live',\r\n      url: '/auth/live',\r\n      authorizationEndpoint: 'https://login.live.com/oauth20_authorize.srf',\r\n      redirectUri: window.location.origin,\r\n      requiredUrlParams: ['display', 'scope'],\r\n      scope: ['wl.emails'],\r\n      scopeDelimiter: ' ',\r\n      display: 'popup',\r\n      oauthType: '2.0',\r\n      popupOptions: { width: 500, height: 560 }\r\n    },\r\n    yahoo: {\r\n      name: 'yahoo',\r\n      url: '/auth/yahoo',\r\n      authorizationEndpoint: 'https://api.login.yahoo.com/oauth2/request_auth',\r\n      redirectUri: window.location.origin,\r\n      scope: [],\r\n      scopeDelimiter: ',',\r\n      oauthType: '2.0',\r\n      popupOptions: { width: 559, height: 519 }\r\n    },\r\n    bitbucket: {\r\n      name: 'bitbucket',\r\n      url: '/auth/bitbucket',\r\n      authorizationEndpoint: 'https://bitbucket.org/site/oauth2/authorize',\r\n      redirectUri: window.location.origin + '/',\r\n      requiredUrlParams: ['scope'],\r\n      scope: ['email'],\r\n      scopeDelimiter: ' ',\r\n      oauthType: '2.0',\r\n      popupOptions: { width: 1028, height: 529 }\r\n    },\r\n    spotify: {\r\n      name: 'spotify',\r\n      url: '/auth/spotify',\r\n      authorizationEndpoint: 'https://accounts.spotify.com/authorize',\r\n      redirectUri: window.location.origin,\r\n      optionalUrlParams: ['state'],\r\n      requiredUrlParams: ['scope'],\r\n      scope: ['user-read-email'],\r\n      scopePrefix: '',\r\n      scopeDelimiter: ',',\r\n      oauthType: '2.0',\r\n      popupOptions: { width: 500, height: 530 },\r\n      state: () => encodeURIComponent(Math.random().toString(36).substr(2))\r\n    }\r\n  };\r\n  httpInterceptor: any = (): boolean => true;\r\n};\r\n","import Config from './config';\r\nimport { IOAuth1Options } from './oauth1';\r\nimport { IOAuth2Options } from './oauth2';\r\n\r\nexport default class AuthProvider {\r\n  static $inject = ['SatellizerConfig'];\r\n\r\n  constructor(private SatellizerConfig: Config) {}\r\n\r\n  get baseUrl(): string { return this.SatellizerConfig.baseUrl; }\r\n  set baseUrl(value) { this.SatellizerConfig.baseUrl = value; }\r\n\r\n  get loginUrl(): string { return this.SatellizerConfig.loginUrl; }\r\n  set loginUrl(value) { this.SatellizerConfig.loginUrl = value; }\r\n\r\n  get signupUrl(): string { return this.SatellizerConfig.signupUrl; }\r\n  set signupUrl(value) { this.SatellizerConfig.signupUrl = value; }\r\n\r\n  get unlinkUrl(): string { return this.SatellizerConfig.unlinkUrl; }\r\n  set unlinkUrl(value) { this.SatellizerConfig.unlinkUrl = value; }\r\n\r\n  get tokenRoot(): string { return this.SatellizerConfig.tokenRoot; }\r\n  set tokenRoot(value) { this.SatellizerConfig.tokenRoot = value; }\r\n\r\n  get tokenName(): string { return this.SatellizerConfig.tokenName; }\r\n  set tokenName(value) { this.SatellizerConfig.tokenName = value; }\r\n\r\n  get tokenPrefix(): string { return this.SatellizerConfig.tokenPrefix; }\r\n  set tokenPrefix(value) { this.SatellizerConfig.tokenPrefix = value; }\r\n\r\n  get tokenHeader(): string { return this.SatellizerConfig.tokenHeader; }\r\n  set tokenHeader(value) { this.SatellizerConfig.tokenHeader = value; }\r\n\r\n  get tokenType(): string { return this.SatellizerConfig.tokenType; }\r\n  set tokenType(value) { this.SatellizerConfig.tokenType = value; }\r\n\r\n  get withCredentials(): boolean { return this.SatellizerConfig.withCredentials; }\r\n  set withCredentials(value) { this.SatellizerConfig.withCredentials = value; }\r\n\r\n  get storageType(): string { return this.SatellizerConfig.storageType; }\r\n  set storageType(value) { this.SatellizerConfig.storageType = value; }\r\n\r\n  get httpInterceptor(): boolean { return this.SatellizerConfig.httpInterceptor; }\r\n  set httpInterceptor(value) {\r\n    if (typeof value === 'function') {\r\n      this.SatellizerConfig.httpInterceptor = value;\r\n    } else {\r\n      this.SatellizerConfig.httpInterceptor = () => value;\r\n    }\r\n  }\r\n\r\n  facebook(options: IOAuth2Options): void {\r\n    angular.extend(this.SatellizerConfig.providers.facebook, options);\r\n  }\r\n\r\n  google(options: IOAuth2Options): void {\r\n    angular.extend(this.SatellizerConfig.providers.google, options);\r\n  }\r\n\r\n  github(options: IOAuth2Options): void {\r\n    angular.extend(this.SatellizerConfig.providers.github, options);\r\n  }\r\n\r\n  instagram(options: IOAuth2Options): void {\r\n    angular.extend(this.SatellizerConfig.providers.instagram, options);\r\n  }\r\n\r\n  linkedin(options: IOAuth2Options): void {\r\n    angular.extend(this.SatellizerConfig.providers.linkedin, options);\r\n  }\r\n\r\n  twitter(options: IOAuth1Options): void {\r\n    angular.extend(this.SatellizerConfig.providers.twitter, options);\r\n  }\r\n\r\n  twitch(options: IOAuth2Options): void {\r\n    angular.extend(this.SatellizerConfig.providers.twitch, options);\r\n  }\r\n\r\n  live(options: IOAuth2Options): void {\r\n    angular.extend(this.SatellizerConfig.providers.live, options);\r\n  }\r\n\r\n  yahoo(options: IOAuth2Options): void {\r\n    angular.extend(this.SatellizerConfig.providers.yahoo, options);\r\n  }\r\n\r\n  bitbucket(options: IOAuth2Options): void {\r\n    angular.extend(this.SatellizerConfig.providers.bitbucket, options);\r\n  }\r\n\r\n  spotify(options: IOAuth2Options): void {\r\n    angular.extend(this.SatellizerConfig.providers.spotify, options);\r\n  }\r\n\r\n  oauth1(options: IOAuth1Options): void {\r\n    this.SatellizerConfig.providers[options.name] = angular.extend(options, {\r\n      oauthType: '1.0'\r\n    });\r\n  }\r\n\r\n  oauth2(options: IOAuth2Options): void {\r\n    this.SatellizerConfig.providers[options.name] = angular.extend(options, {\r\n      oauthType: '2.0'\r\n    });\r\n  }\r\n\r\n  $get(SatellizerShared, SatellizerLocal, SatellizerOAuth): any {\r\n    return {\r\n      login: (user, options) => SatellizerLocal.login(user, options),\r\n      signup: (user, options) => SatellizerLocal.signup(user, options),\r\n      logout: () => SatellizerShared.logout(),\r\n      authenticate: (name, data) => SatellizerOAuth.authenticate(name, data),\r\n      link: (name, data) => SatellizerOAuth.authenticate(name, data),\r\n      unlink: (name, options) => SatellizerOAuth.unlink(name, options),\r\n      isAuthenticated: (roleArg) => SatellizerShared.isAuthenticated(roleArg),\r\n      getPayload: () => SatellizerShared.getPayload(),\r\n      getToken: () => SatellizerShared.getToken(),\r\n      setToken: (token) => SatellizerShared.setToken({ access_token: token }),\r\n      removeToken: () => SatellizerShared.removeToken(),\r\n      setStorageType: (type) => SatellizerShared.setStorageType(type)\r\n    };\r\n  }\r\n}\r\n\r\nAuthProvider.prototype.$get.$inject = ['SatellizerShared', 'SatellizerLocal', 'SatellizerOAuth'];\r\n","export function joinUrl (baseUrl, url) {\r\n  if (/^(?:[a-z]+:)?\\/\\//i.test(url)) {\r\n    return url;\r\n  }\r\n  let joined = [baseUrl, url].join('/');\r\n  let normalize = function (str) {\r\n    return str\r\n      .replace(/[\\/]+/g, '/')\r\n      .replace(/\\/\\?/g, '?')\r\n      .replace(/\\/\\#/g, '#')\r\n      .replace(/\\:\\//g, '://');\r\n  };\r\n  return normalize(joined);\r\n}\r\n\r\nexport function getFullUrlPath (location) {\r\n  const isHttps = location.protocol === 'https:';\r\n  return location.protocol + '//' + location.hostname +\r\n    ':' + (location.port || (isHttps ? '443' : '80')) +\r\n    (/^\\//.test(location.pathname) ? location.pathname : '/' + location.pathname);\r\n}\r\n\r\nexport function parseQueryString (str) {\r\n  let obj = {};\r\n  let key;\r\n  let value;\r\n  angular.forEach((str || '').split('&'), (keyValue) => {\r\n    if (keyValue) {\r\n      value = keyValue.split('=');\r\n      key = decodeURIComponent(value[0]);\r\n      obj[key] = angular.isDefined(value[1]) ? decodeURIComponent(value[1]) : true;\r\n    }\r\n  });\r\n  return obj;\r\n}\r\n\r\nexport function decodeBase64 (str) {\r\n  let buffer;\r\n  if (typeof module !== 'undefined' && module.exports) {\r\n    try {\r\n      buffer = require('buffer').Buffer;\r\n    } catch (err) {\r\n      // noop\r\n    }\r\n  }\r\n\r\n  let fromCharCode = String.fromCharCode;\r\n\r\n  let re_btou = new RegExp([\r\n    '[\\xC0-\\xDF][\\x80-\\xBF]',\r\n    '[\\xE0-\\xEF][\\x80-\\xBF]{2}',\r\n    '[\\xF0-\\xF7][\\x80-\\xBF]{3}'\r\n  ].join('|'), 'g');\r\n\r\n  let cb_btou = function (cccc) {\r\n    switch (cccc.length) {\r\n      case 4:\r\n        let cp = ((0x07 & cccc.charCodeAt(0)) << 18)\r\n          | ((0x3f & cccc.charCodeAt(1)) << 12)\r\n          | ((0x3f & cccc.charCodeAt(2)) << 6)\r\n          | (0x3f & cccc.charCodeAt(3));\r\n        let offset = cp - 0x10000;\r\n        return (fromCharCode((offset >>> 10) + 0xD800)\r\n        + fromCharCode((offset & 0x3FF) + 0xDC00));\r\n      case 3:\r\n        return fromCharCode(\r\n          ((0x0f & cccc.charCodeAt(0)) << 12)\r\n          | ((0x3f & cccc.charCodeAt(1)) << 6)\r\n          | (0x3f & cccc.charCodeAt(2))\r\n        );\r\n      default:\r\n        return fromCharCode(\r\n          ((0x1f & cccc.charCodeAt(0)) << 6)\r\n          | (0x3f & cccc.charCodeAt(1))\r\n        );\r\n    }\r\n  };\r\n\r\n  let btou = function (b) {\r\n    return b.replace(re_btou, cb_btou);\r\n  };\r\n\r\n  let _decode = buffer ? function (a) {\r\n    return (a.constructor === buffer.constructor\r\n      ? a : new buffer(a, 'base64')).toString();\r\n  }\r\n    : function (a) {\r\n    return btou(atob(a));\r\n  };\r\n\r\n  return _decode(\r\n    String(str).replace(/[-_]/g, function (m0) {\r\n      return m0 === '-' ? '+' : '/';\r\n    })\r\n      .replace(/[^A-Za-z0-9\\+\\/]/g, '')\r\n  );\r\n}\r\n","import Config from './config';\r\nimport Storage from './storage';\r\nimport { decodeBase64 } from './utils';\r\n\r\nclass Shared {\r\n  static $inject = ['$q', '$window', 'SatellizerConfig', 'SatellizerStorage'];\r\n\r\n  private prefixedTokenName: string;\r\n\r\n  constructor(private $q: angular.IQService,\r\n              private $window: angular.IWindowService,\r\n              private SatellizerConfig: Config,\r\n              private SatellizerStorage: Storage) {\r\n    const { tokenName, tokenPrefix } = this.SatellizerConfig;\r\n    this.prefixedTokenName = tokenPrefix ? [tokenPrefix, tokenName].join('_') : tokenName;\r\n  }\r\n\r\n  getToken(): string {\r\n    return this.SatellizerStorage.get(this.prefixedTokenName);\r\n  }\r\n\r\n  getPayload(): any {\r\n    const token = this.SatellizerStorage.get(this.prefixedTokenName);\r\n\r\n    if (token && token.split('.').length === 3) {\r\n      try {\r\n        const base64Url = token.split('.')[1];\r\n        const base64 = base64Url.replace('-', '+').replace('_', '/');\r\n        return JSON.parse(decodeBase64(base64));\r\n      } catch (e) {\r\n        // no-op\r\n      }\r\n    }\r\n  }\r\n\r\n  setToken(response): void {\r\n    const tokenRoot = this.SatellizerConfig.tokenRoot;\r\n    const tokenName = this.SatellizerConfig.tokenName;\r\n    const accessToken = response && response.access_token;\r\n\r\n    let token;\r\n\r\n    if (accessToken) {\r\n      if (angular.isObject(accessToken) && angular.isObject(accessToken.data)) {\r\n        response = accessToken;\r\n      } else if (angular.isString(accessToken)) {\r\n        token = accessToken;\r\n      }\r\n    }\r\n\r\n    if (!token && response) {\r\n      const tokenRootData = tokenRoot && tokenRoot.split('.').reduce((o, x) => o[x], response.data);\r\n      token = tokenRootData ? tokenRootData[tokenName] : response.data && response.data[tokenName];\r\n    }\r\n\r\n    if (token) {\r\n      this.SatellizerStorage.set(this.prefixedTokenName, token);\r\n    }\r\n  }\r\n\r\n  removeToken(): void {\r\n    this.SatellizerStorage.remove(this.prefixedTokenName);\r\n  }\r\n\r\n  isAuthenticated(roleArgument): boolean {\r\n    const token = this.SatellizerStorage.get(this.prefixedTokenName);\r\n\r\n    if (token) {  // Token is present\r\n      if (token.split('.').length === 3) {  // Token with a valid JWT format XXX.YYY.ZZZ\r\n        try { // Could be a valid JWT or an access token with the same format\r\n          const base64Url = token.split('.')[1];\r\n          const base64 = base64Url.replace('-', '+').replace('_', '/');\r\n          const exp = JSON.parse(this.$window.atob(base64)).exp;\r\n          const role = JSON.parse(this.$window.atob(base64)).role; // JWT with an optional role claim\r\n          if (typeof exp === 'number') {  // JWT with an optonal expiration claims\r\n            return Math.round(new Date().getTime() / 1000) < exp;\r\n          }\r\n          if (roleArgument) {\r\n            if (roleArgument !== role) {\r\n              return false; // Fail: Supplied role doesn't match role defined in token\r\n            }\r\n          }\r\n        } catch (e) {\r\n          return true;  // Pass: Non-JWT token that looks like JWT\r\n        }\r\n      }\r\n      return true;  // Pass: All other tokens\r\n    }\r\n    return false; // Fail: No token at all\r\n  }\r\n\r\n  logout(): angular.IPromise<void> {\r\n    this.SatellizerStorage.remove(this.prefixedTokenName);\r\n    return this.$q.when();\r\n  }\r\n\r\n  setStorageType(type): void {\r\n    this.SatellizerConfig.storageType = type;\r\n  }\r\n}\r\n\r\nexport default Shared;\r\n","import { joinUrl } from './utils';\r\nimport Config from './config';\r\nimport Shared from './shared';\r\n\r\nclass Local {\r\n  static $inject = ['$http', 'SatellizerConfig', 'SatellizerShared'];\r\n\r\n\r\n  constructor(private $http: angular.IHttpService,\r\n              private SatellizerConfig: Config,\r\n              private SatellizerShared: Shared) {}\r\n\r\n  login(user: string|Object, options: any = {}): angular.IHttpPromise<any> {\r\n    options.url = options.url ? options.url : joinUrl(this.SatellizerConfig.baseUrl, this.SatellizerConfig.loginUrl);\r\n    options.data = user || options.data;\r\n    options.method = options.method || 'POST';\r\n    options.withCredentials = options.withCredentials || this.SatellizerConfig.withCredentials;\r\n\r\n    return this.$http(options).then((response) => {\r\n      this.SatellizerShared.setToken(response);\r\n      return response;\r\n    });\r\n  }\r\n\r\n  signup(user: string|Object, options: any = {}): angular.IHttpPromise<any> {\r\n    options.url = options.url ? options.url : joinUrl(this.SatellizerConfig.baseUrl, this.SatellizerConfig.signupUrl);\r\n    options.data = user || options.data;\r\n    options.method = options.method || 'POST';\r\n    options.withCredentials = options.withCredentials || this.SatellizerConfig.withCredentials;\r\n\r\n    return this.$http(options);\r\n  }\r\n}\r\n\r\nexport default Local;\r\n","import { parseQueryString, getFullUrlPath } from './utils';\r\n\r\nexport interface IPopup {\r\n  open(url: string, name: string, popupOptions: { width: number, height: number }, redirectUri: string): void;\r\n  stringifyOptions (options: any): string;\r\n  polling(redirectUri: string): angular.IPromise<any>;\r\n  eventListener(redirectUri: string): angular.IPromise<any>;\r\n}\r\n\r\nexport default class Popup implements IPopup {\r\n  static $inject = ['$interval', '$window', '$q'];\r\n\r\n  public popup: any;\r\n  private url: string;\r\n  private defaults: { redirectUri: string };\r\n\r\n  constructor(private $interval: angular.IIntervalService,\r\n              private $window: angular.IWindowService,\r\n              private $q: angular.IQService) {\r\n    this.popup = null;\r\n    this.defaults = {\r\n      redirectUri: null\r\n    };\r\n  }\r\n\r\n  stringifyOptions (options: any): string {\r\n    const parts = [];\r\n    angular.forEach(options, function (value, key) {\r\n      parts.push(key + '=' + value);\r\n    });\r\n    return parts.join(',');\r\n  }\r\n\r\n  open(url: string,\r\n       name: string,\r\n       popupOptions: { width: number, height: number },\r\n       redirectUri: string,\r\n       dontPoll?: boolean): angular.IPromise<any> {\r\n    const width = popupOptions.width || 500;\r\n    const height = popupOptions.height || 500;\r\n\r\n    const options = this.stringifyOptions({\r\n      width: width,\r\n      height: height,\r\n      top: this.$window.screenY + ((this.$window.outerHeight - height) / 2.5),\r\n      left: this.$window.screenX + ((this.$window.outerWidth - width) / 2)\r\n    });\r\n\r\n    const popupName = this.$window['cordova'] || this.$window.navigator.userAgent.indexOf('CriOS') > -1 ? '_blank' : name;\r\n\r\n    this.popup = this.$window.open(url, popupName, options);\r\n\r\n    if (this.popup && this.popup.focus) {\r\n      this.popup.focus();\r\n    }\r\n\r\n    if (dontPoll) {\r\n      return;\r\n    }\r\n\r\n    if (this.$window['cordova']) {\r\n      return this.eventListener(redirectUri);\r\n    } else {\r\n      if (url === 'about:blank') {\r\n        this.popup.location = url;\r\n      }\r\n      return this.polling(redirectUri);\r\n    }\r\n\r\n  }\r\n\r\n  polling(redirectUri: string): angular.IPromise<any> {\r\n    return this.$q((resolve, reject) => {\r\n      const redirectUriParser = document.createElement('a');\r\n      redirectUriParser.href = redirectUri;\r\n      const redirectUriPath = getFullUrlPath(redirectUriParser);\r\n\r\n      const polling = this.$interval(() => {\r\n        if (!this.popup || this.popup.closed || this.popup.closed === undefined) {\r\n          this.$interval.cancel(polling);\r\n          reject(new Error('The popup window was closed'));\r\n        }\r\n\r\n        try {\r\n          const popupWindowPath = getFullUrlPath(this.popup.location);\r\n\r\n          if (popupWindowPath === redirectUriPath) {\r\n            if (this.popup.location.search || this.popup.location.hash) {\r\n              const query = parseQueryString(this.popup.location.search.substring(1).replace(/\\/$/, ''));\r\n              const hash = parseQueryString(this.popup.location.hash.substring(1).replace(/[\\/$]/, ''));\r\n              const params = angular.extend({}, query, hash);\r\n\r\n              if (params.error) {\r\n                reject(new Error(params.error));\r\n              } else {\r\n                resolve(params);\r\n              }\r\n            } else {\r\n              reject(new Error(\r\n                'OAuth redirect has occurred but no query or hash parameters were found. ' +\r\n                'They were either not set during the redirect, or were removed—typically by a ' +\r\n                'routing library—before Satellizer could read it.'\r\n              ));\r\n            }\r\n\r\n            this.$interval.cancel(polling);\r\n            this.popup.close();\r\n          }\r\n        } catch (error) {\r\n          // Ignore DOMException: Blocked a frame with origin from accessing a cross-origin frame.\r\n          // A hack to get around same-origin security policy errors in IE.\r\n        }\r\n      }, 500);\r\n    });\r\n  }\r\n\r\n  eventListener(redirectUri): angular.IPromise<any> {\r\n    return this.$q((resolve, reject) => {\r\n      this.popup.addEventListener('loadstart', (event) => {\r\n        if (event.url.indexOf(redirectUri) !== 0) {\r\n          return;\r\n        }\r\n\r\n        const parser = document.createElement('a');\r\n        parser.href = event.url;\r\n\r\n        if (parser.search || parser.hash) {\r\n          const query = parseQueryString(parser.search.substring(1).replace(/\\/$/, ''));\r\n          const hash = parseQueryString(parser.hash.substring(1).replace(/[\\/$]/, ''));\r\n          const params = angular.extend({}, query, hash);\r\n\r\n          if (params.error) {\r\n            reject(new Error(params.error));\r\n          } else {\r\n            resolve(params);\r\n          }\r\n\r\n          this.popup.close();\r\n        }\r\n      });\r\n\r\n      this.popup.addEventListener('loaderror', () => {\r\n        reject(new Error('Authorization failed'));\r\n      });\r\n\r\n      this.popup.addEventListener('exit', () => {\r\n        reject(new Error('The popup window was closed'));\r\n      });\r\n    });\r\n  }\r\n}\r\n","import { joinUrl } from './utils';\r\nimport Config from './config';\r\nimport Popup from './popup';\r\nimport { IOAuth1Options } from './oauth1';\r\n\r\nexport interface IOAuth1 {\r\n  init(options: any, data: any): angular.IPromise<any>;\r\n  getRequestToken(): angular.IHttpPromise<any>;\r\n  openPopup(options: IOAuth1Options, response: angular.IHttpPromiseCallbackArg<any>): angular.IPromise<any>;\r\n  exchangeForToken(oauthData: any, userData: any): angular.IHttpPromise<any>;\r\n  buildQueryString(obj: any): string;\r\n}\r\n\r\nexport interface IOAuth1Options {\r\n  name: string;\r\n  url: string;\r\n  authorizationEndpoint: string;\r\n  redirectUri: string;\r\n  scope: string[];\r\n  scopePrefix: string;\r\n  scopeDelimiter: string;\r\n  requiredUrlParams: string[];\r\n  defaultUrlParams: string[];\r\n  oauthType: string;\r\n  popupOptions: { width: number, height: number };\r\n}\r\n\r\nexport default class OAuth1 implements IOAuth1 {\r\n  static $inject = ['$http', '$window', 'SatellizerConfig', 'SatellizerPopup'];\r\n\r\n  private defaults: IOAuth1Options;\r\n\r\n  constructor(private $http: angular.IHttpService,\r\n              private $window: angular.IWindowService,\r\n              private SatellizerConfig: Config,\r\n              private SatellizerPopup: Popup) {\r\n\r\n    this.defaults = {\r\n      name: null,\r\n      url: null,\r\n      authorizationEndpoint: null,\r\n      scope: null,\r\n      scopePrefix: null,\r\n      scopeDelimiter: null,\r\n      redirectUri: null,\r\n      requiredUrlParams: null,\r\n      defaultUrlParams: null,\r\n      oauthType: '1.0',\r\n      popupOptions: { width: null, height: null }\r\n    };\r\n  };\r\n\r\n  init(options: IOAuth1Options, userData: any): angular.IHttpPromise<any> {\r\n    angular.extend(this.defaults, options);\r\n    const { name, popupOptions } = options;\r\n    const { redirectUri } = this.defaults;\r\n\r\n    // Should open an empty popup and wait until request token is received\r\n    if (!this.$window['cordova']) {\r\n      this.SatellizerPopup.open('about:blank', name, popupOptions, redirectUri, true);\r\n    }\r\n\r\n    return this.getRequestToken().then((response) => {\r\n      return this.openPopup(options, response).then((popupResponse) => {\r\n        return this.exchangeForToken(popupResponse, userData);\r\n      });\r\n    });\r\n  }\r\n\r\n  openPopup(options: IOAuth1Options, response: angular.IHttpPromiseCallbackArg<any>): angular.IPromise<any> {\r\n    const url = [options.authorizationEndpoint, this.buildQueryString(response.data)].join('?');\r\n    const { redirectUri } = this.defaults;\r\n\r\n    if (this.$window['cordova']) {\r\n      return this.SatellizerPopup.open(url, options.name, options.popupOptions, redirectUri);\r\n    } else {\r\n      this.SatellizerPopup.popup.location = url;\r\n      return this.SatellizerPopup.polling(redirectUri);\r\n    }\r\n  }\r\n\r\n  getRequestToken(): angular.IHttpPromise<any> {\r\n    const url = this.SatellizerConfig.baseUrl ? joinUrl(this.SatellizerConfig.baseUrl, this.defaults.url) : this.defaults.url;\r\n    return this.$http.post(url, this.defaults);\r\n  }\r\n\r\n  exchangeForToken(oauthData, userData): angular.IHttpPromise<any> {\r\n    const payload = angular.extend({}, userData, oauthData);\r\n    const exchangeForTokenUrl = this.SatellizerConfig.baseUrl ? joinUrl(this.SatellizerConfig.baseUrl, this.defaults.url) : this.defaults.url;\r\n    return this.$http.post(exchangeForTokenUrl, payload, { withCredentials: this.SatellizerConfig.withCredentials });\r\n  }\r\n\r\n  buildQueryString(obj): string {\r\n    const str = [];\r\n    angular.forEach(obj, function (value, key) {\r\n      str.push(encodeURIComponent(key) + '=' + encodeURIComponent(value));\r\n    });\r\n    return str.join('&');\r\n  }\r\n}\r\n","import { joinUrl } from './utils';\r\nimport Config from './config';\r\nimport Popup from './popup';\r\nimport Storage from './storage';\r\n\r\nexport interface IOAuth2Options {\r\n  name: string;\r\n  url: string;\r\n  clientId: string;\r\n  authorizationEndpoint: string;\r\n  redirectUri: string;\r\n  scope: string[];\r\n  scopePrefix: string;\r\n  scopeDelimiter: string;\r\n  state?: string|(() => string);\r\n  requiredUrlParams: string[];\r\n  defaultUrlParams: string[];\r\n  responseType: string;\r\n  responseParams: {\r\n    code: string,\r\n    clientId: string,\r\n    redirectUri: string\r\n  };\r\n  oauthType: string;\r\n  popupOptions: { width: number, height: number };\r\n}\r\n\r\nexport default class OAuth2 {\r\n  static $inject = ['$http', '$window', '$timeout', '$q', 'SatellizerConfig', 'SatellizerPopup', 'SatellizerStorage'];\r\n\r\n  static camelCase(name): string {\r\n    return name.replace(/([\\:\\-\\_]+(.))/g, (_, separator, letter, offset) => {\r\n      return offset ? letter.toUpperCase() : letter;\r\n    });\r\n  }\r\n\r\n  public defaults: IOAuth2Options;\r\n\r\n  constructor(private $http: angular.IHttpService,\r\n              private $window: angular.IWindowService,\r\n              private $timeout: angular.ITimeoutService,\r\n              private $q: angular.IQService,\r\n              private SatellizerConfig: Config,\r\n              private SatellizerPopup: Popup,\r\n              private SatellizerStorage: Storage) {\r\n\r\n    this.defaults = {\r\n      name: null,\r\n      url: null,\r\n      clientId: null,\r\n      authorizationEndpoint: null,\r\n      redirectUri: null,\r\n      scope: null,\r\n      scopePrefix: null,\r\n      scopeDelimiter: null,\r\n      state: null,\r\n      requiredUrlParams: null,\r\n      defaultUrlParams: ['response_type', 'client_id', 'redirect_uri'],\r\n      responseType: 'code',\r\n      responseParams: {\r\n        code: 'code',\r\n        clientId: 'clientId',\r\n        redirectUri: 'redirectUri'\r\n      },\r\n      oauthType: '2.0',\r\n      popupOptions: { width: null, height: null }\r\n    };\r\n  }\r\n\r\n  init(options: IOAuth2Options, userData: any): angular.IPromise<any> {\r\n    return this.$q((resolve, reject) => {\r\n      angular.extend(this.defaults, options);\r\n\r\n      const stateName = this.defaults.name + '_state';\r\n      const { name, state, popupOptions, redirectUri, responseType } = this.defaults;\r\n\r\n      if (typeof state === 'function') {\r\n        this.SatellizerStorage.set(stateName, state());\r\n      } else if (typeof state === 'string') {\r\n        this.SatellizerStorage.set(stateName, state);\r\n      }\r\n\r\n      const url = [this.defaults.authorizationEndpoint, this.buildQueryString()].join('?');\r\n\r\n      this.SatellizerPopup.open(url, name, popupOptions, redirectUri).then((oauth: any): void|angular.IPromise<any>|angular.IHttpPromise<any> => {\r\n        if (responseType === 'token' || !url) {\r\n          return resolve(oauth);\r\n        }\r\n\r\n        if (oauth.state && oauth.state !== this.SatellizerStorage.get(stateName)) {\r\n          return reject(new Error(\r\n            'The value returned in the state parameter does not match the state value from your original ' +\r\n            'authorization code request.'\r\n          ));\r\n        }\r\n\r\n        resolve(this.exchangeForToken(oauth, userData));\r\n      }).catch(error => reject(error));\r\n    });\r\n  }\r\n\r\n  exchangeForToken(oauthData: { code?, state? }, userData: any): angular.IHttpPromise<any> {\r\n    const payload = angular.extend({}, userData);\r\n\r\n    angular.forEach(this.defaults.responseParams, (value, key) => {\r\n      switch (key) {\r\n        case 'code':\r\n          payload[value] = oauthData.code;\r\n          break;\r\n        case 'clientId':\r\n          payload[value] = this.defaults.clientId;\r\n          break;\r\n        case 'redirectUri':\r\n          payload[value] = this.defaults.redirectUri;\r\n          break;\r\n        default:\r\n          payload[value] = oauthData[key];\r\n      }\r\n    });\r\n\r\n    if (oauthData.state) {\r\n      payload.state = oauthData.state;\r\n    }\r\n\r\n    let exchangeForTokenUrl = this.SatellizerConfig.baseUrl ?\r\n      joinUrl(this.SatellizerConfig.baseUrl, this.defaults.url) :\r\n      this.defaults.url;\r\n\r\n    return this.$http.post(exchangeForTokenUrl, payload, { withCredentials: this.SatellizerConfig.withCredentials });\r\n  }\r\n\r\n  buildQueryString(): string {\r\n    const keyValuePairs = [];\r\n    const urlParamsCategories = ['defaultUrlParams', 'requiredUrlParams', 'optionalUrlParams'];\r\n\r\n    angular.forEach(urlParamsCategories, (paramsCategory) => {\r\n      angular.forEach(this.defaults[paramsCategory], (paramName) => {\r\n        const camelizedName = OAuth2.camelCase(paramName);\r\n        let paramValue = angular.isFunction(this.defaults[paramName]) ? this.defaults[paramName]() : this.defaults[camelizedName];\r\n\r\n        if (paramName === 'redirect_uri' && !paramValue) {\r\n          return;\r\n        }\r\n        if (paramName === 'state') {\r\n          const stateName = this.defaults.name + '_state';\r\n          paramValue = encodeURIComponent(this.SatellizerStorage.get(stateName));\r\n        }\r\n        if (paramName === 'scope' && Array.isArray(paramValue)) {\r\n          paramValue = paramValue.join(this.defaults.scopeDelimiter);\r\n          if (this.defaults.scopePrefix) {\r\n            paramValue = [this.defaults.scopePrefix, paramValue].join(this.defaults.scopeDelimiter);\r\n          }\r\n        }\r\n\r\n        keyValuePairs.push([paramName, paramValue]);\r\n      });\r\n    });\r\n\r\n    return keyValuePairs.map(pair => pair.join('=')).join('&');\r\n  }\r\n}\r\n","import { joinUrl } from './utils';\r\nimport Config from './config';\r\nimport Popup from './popup';\r\nimport Storage from './storage';\r\nimport Shared from './shared';\r\nimport OAuth1 from './oauth1';\r\nimport OAuth2 from './oauth2';\r\n\r\nexport default class OAuth {\r\n  static $inject = [\r\n    '$http',\r\n    '$window',\r\n    '$timeout',\r\n    '$q',\r\n    'SatellizerConfig',\r\n    'SatellizerPopup',\r\n    'SatellizerStorage',\r\n    'SatellizerShared',\r\n    'SatellizerOAuth1',\r\n    'SatellizerOAuth2'\r\n  ];\r\n\r\n  constructor(private $http: angular.IHttpService,\r\n              private $window: angular.IWindowService,\r\n              private $timeout: angular.ITimeoutService,\r\n              private $q: angular.IQService,\r\n              private SatellizerConfig: Config,\r\n              private SatellizerPopup: Popup,\r\n              private SatellizerStorage: Storage,\r\n              private SatellizerShared: Shared,\r\n              private SatellizerOAuth1: OAuth1,\r\n              private SatellizerOAuth2: OAuth2) {}\r\n\r\n  authenticate(name: string, userData?: any): angular.IPromise<any> {\r\n    return this.$q((resolve, reject) => {\r\n      const provider = this.SatellizerConfig.providers[name];\r\n\r\n      let oauth = null;\r\n\r\n      switch (provider.oauthType) {\r\n        case '1.0':\r\n          oauth = new OAuth1(this.$http, this.$window, this.SatellizerConfig, this.SatellizerPopup);\r\n          break;\r\n        case '2.0':\r\n          oauth = new OAuth2(this.$http, this.$window, this.$timeout, this.$q, this.SatellizerConfig, this.SatellizerPopup, this.SatellizerStorage);\r\n          break;\r\n        default:\r\n          return reject(new Error('Invalid OAuth Type'));\r\n      }\r\n\r\n      return oauth.init(provider, userData).then((response) => {\r\n        if (provider.url) {\r\n          this.SatellizerShared.setToken(response);\r\n        }\r\n        resolve(response);\r\n      }).catch((error) => {\r\n        reject(error);\r\n      });\r\n    });\r\n  }\r\n\r\n  unlink(provider: string, httpOptions: any = {}): angular.IHttpPromise<any> {\r\n    httpOptions.url = httpOptions.url ? httpOptions.url : joinUrl(this.SatellizerConfig.baseUrl, this.SatellizerConfig.unlinkUrl);\r\n    httpOptions.data = { provider: provider } || httpOptions.data;\r\n    httpOptions.method = httpOptions.method || 'POST';\r\n    httpOptions.withCredentials = httpOptions.withCredentials || this.SatellizerConfig.withCredentials;\r\n\r\n    return this.$http(httpOptions);\r\n  }\r\n}\r\n","import Config from './config';\r\n\r\nexport default class Storage {\r\n  static $inject = ['$window', 'SatellizerConfig'];\r\n\r\n  private memoryStore: any;\r\n  private storageType: string;\r\n\r\n  constructor(private $window: angular.IHttpService,\r\n              private SatellizerConfig: Config) {\r\n    this.memoryStore = {};\r\n  }\r\n\r\n  get(key: string): string {\r\n    try {\r\n      return this.$window[this.SatellizerConfig.storageType].getItem(key);\r\n    } catch (e) {\r\n      return this.memoryStore[key];\r\n    }\r\n  }\r\n\r\n  set(key: string, value: string): void {\r\n    try {\r\n      this.$window[this.SatellizerConfig.storageType].setItem(key, value);\r\n    } catch (e) {\r\n      this.memoryStore[key] = value;\r\n    }\r\n  }\r\n\r\n  remove(key: string): void {\r\n    try {\r\n      this.$window[this.SatellizerConfig.storageType].removeItem(key);\r\n    } catch (e) {\r\n      delete this.memoryStore[key];\r\n    }\r\n  }\r\n}\r\n","import Config from './config';\r\nimport Shared from './shared';\r\nimport Storage from './storage';\r\n\r\nexport default class Interceptor implements angular.IHttpInterceptor {\r\n\r\n  static $inject = ['SatellizerConfig', 'SatellizerShared', 'SatellizerStorage'];\r\n\r\n  static Factory(SatellizerConfig: Config, SatellizerShared: Shared, SatellizerStorage: Storage): Interceptor {\r\n    return new Interceptor(SatellizerConfig, SatellizerShared, SatellizerStorage);\r\n  }\r\n\r\n  constructor(private SatellizerConfig: Config,\r\n              private SatellizerShared: Shared,\r\n              private SatellizerStorage: Storage) {\r\n  }\r\n\r\n  request = (config: angular.IRequestConfig): angular.IRequestConfig => {\r\n    if (config['skipAuthorization']) {\r\n      return config;\r\n    }\r\n\r\n    if (this.SatellizerShared.isAuthenticated() && this.SatellizerConfig.httpInterceptor()) {\r\n      const tokenName = this.SatellizerConfig.tokenPrefix ?\r\n        [this.SatellizerConfig.tokenPrefix, this.SatellizerConfig.tokenName].join('_') : this.SatellizerConfig.tokenName;\r\n      let token = this.SatellizerStorage.get(tokenName);\r\n\r\n      if (this.SatellizerConfig.tokenHeader && this.SatellizerConfig.tokenType) {\r\n        token = this.SatellizerConfig.tokenType + ' ' + token;\r\n      }\r\n\r\n      config.headers[this.SatellizerConfig.tokenHeader] = token;\r\n    }\r\n\r\n    return config;\r\n  };\r\n}\r\n\r\nInterceptor.Factory.$inject = ['SatellizerConfig', 'SatellizerShared', 'SatellizerStorage'];","import Interceptor from './interceptor';\r\n\r\nexport default class HttpProviderConfig {\r\n  static $inject = ['$httpProvider'];\r\n\r\n  constructor(private $httpProvider: angular.IHttpProvider) {\r\n    $httpProvider.interceptors.push(Interceptor.Factory);\r\n  }\r\n}\r\n","import Config from './config';\r\nimport AuthProvider from './authProvider';\r\nimport Shared from './shared';\r\nimport Local from './local';\r\nimport Popup from './popup';\r\nimport OAuth from './oauth';\r\nimport OAuth2 from './oauth2';\r\nimport OAuth1 from './oauth1';\r\nimport Storage from './storage';\r\nimport Interceptor from './interceptor';\r\nimport HttpProviderConfig from './httpProviderConfig';\r\n\r\nangular.module('satellizerRoles', [])\r\n  .provider('$auth', ['SatellizerConfig', (SatellizerConfig) => new AuthProvider(SatellizerConfig)])\r\n  .constant('SatellizerConfig', Config.getConstant)\r\n  .service('SatellizerShared', Shared)\r\n  .service('SatellizerLocal', Local)\r\n  .service('SatellizerPopup', Popup)\r\n  .service('SatellizerOAuth', OAuth)\r\n  .service('SatellizerOAuth2', OAuth2)\r\n  .service('SatellizerOAuth1', OAuth1)\r\n  .service('SatellizerStorage', Storage)\r\n  .service('SatellizerInterceptor', Interceptor)\r\n  .config(['$httpProvider', ($httpProvider) => new HttpProviderConfig($httpProvider)]);\r\n\r\nexport default 'satellizerRoles';\r\n"],"names":[],"mappings":"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"}